(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{232:function(e,t,a){e.exports=a(417)},237:function(e,t,a){},395:function(e,t){},417:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(17),s=a.n(i),o=(a(237),a(21)),c=a(22),l=a(24),u=a(23),h=a(25),p=a(419),d=a(420),m=a(151),g=(a(245),m.initializeApp({apiKey:"AIzaSyB7780W1NWElLt08G9K8AxakK29ocEVwNs",authDomain:"independent-studies-2018-2019.firebaseapp.com",databaseURL:"https://independent-studies-2018-2019.firebaseio.com",projectId:"independent-studies-2018-2019",storageBucket:"independent-studies-2018-2019.appspot.com",messagingSenderId:"523918752724"})),f=a(68),v=a.n(f),b=a(62),y=a.n(b),C=a(65),w=a.n(C),E=a(46),S=a.n(E),O=a(27),j=a.n(O),k=a(47),x=a.n(k),N=a(157),P=a.n(N),_=a(19),I=a(8),T=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(I.f,{button:!0,onClick:function(){return e.props.onChatItemClicked(e.props.chat_id)}},r.a.createElement(I.b,{src:"/resources/BobSaget.jpg"}),r.a.createElement(I.g,{primary:this.props.name}))}}]),t}(n.Component),M=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.date,t=e.getHours(),a="AM";t>12&&(t%=12,a="PM");var n=" ".concat(e.getHours(),":").concat(e.getMinutes()," ").concat(a," | ").concat(["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()]," ").concat(e.getDate());return r.a.createElement("div",{className:"incoming_msg"},r.a.createElement("div",{className:"incoming_msg_name"},r.a.createElement("p",null,this.props.name)),r.a.createElement("div",{className:"incoming_msg_img"}," ",r.a.createElement(I.b,{src:this.props.profilePicture,alt:"sunil"})," "),r.a.createElement("div",{className:"received_msg"},r.a.createElement("div",{className:"received_withd_msg"},r.a.createElement("p",null,this.props.message),r.a.createElement("span",{className:"time_date"},n))))}}]),t}(n.Component),W=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.date,t=e.getHours(),a="AM";t>12&&(t%=12,a="PM");var n=" ".concat(e.getHours(),":").concat(e.getMinutes()," ").concat(a," | ").concat(["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()]," ").concat(e.getDate());return r.a.createElement("div",{className:"outgoing_msg"},r.a.createElement("div",{className:"sent_msg"},r.a.createElement("p",null,this.props.message),r.a.createElement("span",{className:"time_date"},n)," "))}}]),t}(n.Component),U="https://".concat(window.location.host),z={},A=function(){},D=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={messages:[]},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e){var t=this;e.startTime!==this.state.startTime&&this.setState({startTime:e.startTime}),e.chat_id&&g.auth().currentUser&&g.auth().currentUser.getIdToken(!0).then(function(a){fetch("".concat(U,"/api/chats/messages/").concat(e.chat_id),{headers:{authorization:a}}).then(function(e){return e.json()}).then(function(e){t.setState({messages:e}),t.messagesEnd.scrollIntoView({behavior:"smooth"})})})}},{key:"componentDidMount",value:function(){var e=this;A=function(t){var a=e.state.messages;a.push(t),e.setState({messages:a}),e.messagesEnd.scrollIntoView({behavior:"smooth"})}}},{key:"renderMessages",value:function(){if(g.auth().currentUser){for(var e=this.state.messages,t=[],a=0;a<e.length;a++)e[a].Owner===g.auth().currentUser.uid?t.push(r.a.createElement(W,{message:e[a].Message,date:new Date(e[a].Time_Sent.replace(" ","T"))})):t.push(r.a.createElement(M,{message:e[a].Message,date:new Date(e[a].Time_Sent.replace(" ","T")),name:e[a].name,profilePicture:e[a].profile_picture}));return t}}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"mesgs"},r.a.createElement("div",null,this.renderMessages(),r.a.createElement("div",{style:{float:"left",clear:"both"},ref:function(t){e.messagesEnd=t}})))}}]),t}(n.Component),B=a(69),L=a(31),J=a(160),R=a(161),F=a(6),V=a.n(F),q=a(64),G=a.n(q),K=a(29),H=a.n(K),Q=a(67),$=a.n(Q),X=a(66),Y=a.n(X),Z=a(153),ee=a.n(Z),te=a(39),ae=a(63),ne=a.n(ae);function re(e){var t=e.inputRef,a=Object(J.a)(e,["inputRef"]);return r.a.createElement("div",Object.assign({ref:t},a))}var ie={Control:function(e){return r.a.createElement(G.a,Object.assign({fullWidth:!0,InputProps:{inputComponent:re,inputProps:Object(L.a)({className:e.selectProps.classes.input,inputRef:e.innerRef,children:e.children},e.innerProps)}},e.selectProps.textFieldProps))},Menu:function(e){return r.a.createElement(H.a,Object.assign({square:!0,className:e.selectProps.classes.paper},e.innerProps),e.children)},MultiValue:function(e){return r.a.createElement($.a,{tabIndex:-1,label:e.children,className:V()(e.selectProps.classes.chip,Object(B.a)({},e.selectProps.classes.chipFocused,e.isFocused)),onDelete:e.removeProps.onClick,deleteIcon:r.a.createElement(ee.a,e.removeProps)})},NoOptionsMessage:function(e){return r.a.createElement(j.a,Object.assign({color:"textSecondary",className:e.selectProps.classes.noOptionsMessage},e.innerProps),e.children)},Option:function(e){return r.a.createElement(Y.a,Object.assign({buttonRef:e.innerRef,selected:e.isFocused,component:"div",style:{fontWeight:e.isSelected?500:400}},e.innerProps),e.children)},Placeholder:function(e){return r.a.createElement(j.a,Object.assign({color:"textSecondary",className:e.selectProps.classes.placeholder},e.innerProps),e.children)},SingleValue:function(e){return r.a.createElement(j.a,Object.assign({className:e.selectProps.classes.singleValue},e.innerProps),e.children)},ValueContainer:function(e){return r.a.createElement("div",{className:e.selectProps.classes.valueContainer},e.children)}},se=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={names:null,suggestions:[],chat_name:""},a.handleChange=function(e){return function(e){a.setState({names:e})}},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch("".concat(U,"/api/users")).then(function(e){return e.json()}).then(function(t){for(var a=[],n=0;n<t.length;n++)t[n].ID!==g.auth().currentUser.uid&&a.push({label:t[n].name,id:t[n].ID});e.setState({suggestions:a.map(function(e){return{value:e.label,label:e.label,id:e.id}})})})}},{key:"handleChatNameChange",value:function(e){this.setState({chat_name:e.target.value})}},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.theme,n={input:function(e){return Object(L.a)({},e,{color:a.palette.text.primary,"& input":{font:"inherit"}})}};return r.a.createElement("div",{style:{marginTop:60}},r.a.createElement(I.e,{onChange:this.handleChatNameChange.bind(this),type:"text",value:this.state.chat_name,placeholder:"Chat Name",style:{marginBottom:20},fullWidth:!0}),r.a.createElement(R.a,{classes:t,styles:n,textFieldProps:{label:"Chat members",InputLabelProps:{shrink:!0}},options:this.state.suggestions,components:ie,value:this.state.multi,onChange:this.handleChange("multi"),placeholder:"Select one or more people",isMulti:!0}),r.a.createElement(ne.a,{variant:"outlined",style:{marginTop:10},onClick:this.onCreateChatClicked.bind(this)},"Create Chat"))}},{key:"onCreateChatClicked",value:function(){var e=this;this.state.chat_name&&g.auth().currentUser.getIdToken(!0).then(function(t){fetch("".concat(U,"/api/chats"),{method:"POST",body:JSON.stringify({chat_name:e.state.chat_name,members:e.state.names}),headers:{"Content-Type":"application/json",authorization:t}}).then(function(){e.props.onNewChat()})})}}]),t}(n.Component),oe=Object(_.withStyles)(function(e){return{root:{flexGrow:1,height:250},input:{display:"flex",padding:0},valueContainer:{display:"flex",flexWrap:"wrap",flex:1,alignItems:"center"},chip:{margin:"".concat(e.spacing.unit/2,"px ").concat(e.spacing.unit/4,"px")},chipFocused:{backgroundColor:Object(te.emphasize)("light"===e.palette.type?e.palette.grey[300]:e.palette.grey[700],.08)},noOptionsMessage:{padding:"".concat(e.spacing.unit,"px ").concat(2*e.spacing.unit,"px")},singleValue:{fontSize:16},placeholder:{position:"absolute",left:2,fontSize:16},paper:{position:"absolute",zIndex:1,marginTop:e.spacing.unit,left:0,right:0},divider:{height:2*e.spacing.unit}}},{withTheme:!0})(se),ce=240,le=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={shouldShowNewChat:!1,chats:[],current_chat_id:void 0,gotChats:!1},a._handleKeyPress=function(e){"Enter"===e.key&&a.sendChatTest()},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"getChats",value:function(){var e=this;g.auth().currentUser.getIdToken(!0).then(function(t){fetch("".concat(U,"/api/chats"),{headers:{"Content-Type":"application/json",authorization:t}}).then(function(e){return e.json()}).then(function(t){var a=void 0;t.length>0&&(a=t[0].Chat_ID),e.setState({chats:t,current_chat_id:a})})})}},{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=t.user,i=this.state.shouldShowNewChat;return g.auth().currentUser&&!this.state.gotChats&&(this.setState({gotChats:!0}),this.getChats()),0===Object.keys(n).length&&this.props.history.push("/Login"),r.a.createElement("div",{className:a.root},r.a.createElement(y.a,{position:"absolute",className:a.appBar},r.a.createElement(w.a,null,r.a.createElement(j.a,{variant:"title",color:"inherit",noWrap:!0,style:{flex:1}},"Comic Sans Chat"),r.a.createElement(I.c,{label:"Default",style:{textTransform:"none",color:"white"},onClick:this.signOut.bind(this)},n.email||""))),r.a.createElement(v.a,{variant:"permanent",classes:{paper:a.drawerPaper}},r.a.createElement(S.a,{style:{marginTop:60}},r.a.createElement(I.f,{button:!0,onClick:function(){return e.setState({shouldShowNewChat:!0})}},r.a.createElement(I.b,null,r.a.createElement(P.a,null)),r.a.createElement(I.g,{primary:"Create new Chat"})),r.a.createElement(x.a,null),this.renderChats())),i?this.renderNewChat():this.renderChat())}},{key:"onChatCreated",value:function(){this.setState({shouldShowNewChat:!1}),this.getChats()}},{key:"renderChats",value:function(){for(var e=this,t=[],a=0;a<this.state.chats.length;a++)t.push(r.a.createElement("div",{key:this.state.chats[a].Chat_ID},r.a.createElement(T,{chat_id:this.state.chats[a].Chat_ID,onChatItemClicked:function(t){return e.onChatItemClicked(t)},name:this.state.chats[a].chat_name}),r.a.createElement(x.a,null)));return t}},{key:"onChatItemClicked",value:function(e){this.setState({shouldShowNewChat:!1,current_chat_id:e})}},{key:"signOut",value:function(){g.auth().signOut()}},{key:"navigateToLogin",value:function(){this.props.history.push("/Login")}},{key:"renderNewChat",value:function(){var e=this.props.classes,t="".concat(e.content," main-content");return r.a.createElement("main",{className:t},r.a.createElement(oe,{onNewChat:this.onChatCreated.bind(this)}))}},{key:"sendChatTest",value:function(){var e,t,a=this.state,n=a.inputText,r=a.current_chat_id;n&&(e=r,t=n,z.emit("chat",{chat_id:e,message:t}),this.setState({inputText:""}))}},{key:"renderChat",value:function(){var e=this,t=this.props.classes,a="".concat(t.content," main-content");return r.a.createElement("main",{className:a},r.a.createElement("div",null),r.a.createElement(D,{chat_id:this.state.current_chat_id}),r.a.createElement("div",{className:"type_msg"},r.a.createElement("div",{className:"input_msg_write"},r.a.createElement("input",{type:"text",className:"write_msg",placeholder:"Type a message",onChange:function(t){e.setState({inputText:t.target.value})},value:this.state.inputText,onKeyPress:this._handleKeyPress.bind(this)}),r.a.createElement("button",{className:"msg_send_btn",type:"button",onClick:function(){return e.sendChatTest()}},r.a.createElement("i",{className:"far fa-paper-plane","aria-hidden":"true"})))))}}]),t}(n.Component),ue=Object(_.withStyles)(function(e){return{root:{flexGrow:1,zIndex:1,overflow:"hidden",position:"relative",display:"flex",height:"100vh",flex:1},appBar:{zIndex:e.zIndex.drawer+1},drawerPaper:{position:"relative",whiteSpace:"nowrap",width:ce,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},content:{flexGrow:1,backgroundColor:e.palette.background.default,padding:3*e.spacing.unit,minWidth:0},toolbar:e.mixins.toolbar}})(le),he=240,pe={cardStyle:{margin:10,paddingLeft:10,paddingRight:10,width:500,paddingTop:10,paddingBottom:10},divStyle:{alignItems:"center",justifyContent:"center",flex:1,display:"flex",flexDirection:"column"},buttonStyle:{marginTop:10},errorStyle:{color:"red",marginBottom:10}},de=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={email:"",password:"",error:"",name:"",profilePicture:"",signUpScreen:!1},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.classes;Object.keys(this.props.user).length>0&&this.props.history.push("/");var t="".concat(e.content," main-content");return r.a.createElement("div",{className:e.root},r.a.createElement(I.a,{position:"absolute",className:e.appBar},r.a.createElement(I.i,null,r.a.createElement(I.j,{variant:"title",color:"inherit",noWrap:!0,style:{flex:1}},"Comic Sans Chat"),r.a.createElement(I.c,{color:"inherit"},"Login"))),r.a.createElement("main",{className:t},r.a.createElement("div",{className:e.toolbar}),r.a.createElement("div",{style:pe.divStyle},this.renderContent())))}},{key:"renderContent",value:function(){var e=this,t=""!==this.state.error&&void 0!==this.state.error?r.a.createElement("p",{style:pe.errorStyle},this.state.error):null;return this.state.signUpScreen?r.a.createElement(I.d,{style:pe.cardStyle},r.a.createElement(I.j,{variant:"headline",component:"h3"},"Please Sign Up"),r.a.createElement(I.h,{id:"email-input",label:"Email",type:"email",autoComplete:"email",margin:"normal",fullWidth:!0,value:this.state.email,error:""!==this.state.error,onChange:function(t){return e.emailChanged(t.target.value)}}),r.a.createElement(I.h,{id:"password-input",label:"Password",type:"password",autoComplete:"password",margin:"normal",fullWidth:!0,value:this.state.password,error:""!==this.state.error,onChange:function(t){return e.passwordChanged(t.target.value)}}),r.a.createElement(I.h,{id:"password-input",label:"Name",type:"text",autoComplete:"name",margin:"normal",fullWidth:!0,value:this.state.name,error:""!==this.state.error,onChange:function(t){return e.nameChanged(t.target.value)}}),r.a.createElement(I.h,{id:"password-input",label:"Profile Picture",type:"text",margin:"normal",fullWidth:!0,value:this.state.profilePicture,error:""!==this.state.error,onChange:function(t){return e.profilePictureChanged(t.target.value)}}),t,r.a.createElement("div",null,r.a.createElement(I.c,{variant:"contained",size:"large",color:"primary",onClick:this.signUp.bind(this),style:Object(L.a)({},pe.buttonStyle,{flex:1,float:"right"})},"Submit"),r.a.createElement(I.c,{variant:"contained",size:"large",color:"primary",onClick:this.loginScreen.bind(this),style:Object(L.a)({},pe.buttonStyle,{float:"left"})},"Log In"))):r.a.createElement(I.d,{style:pe.cardStyle},r.a.createElement(I.j,{variant:"headline",component:"h3"},"Please Sign In"),r.a.createElement(I.h,{id:"email-input",label:"Email",type:"email",autoComplete:"email",margin:"normal",fullWidth:!0,value:this.state.email,error:""!==this.state.error,onChange:function(t){return e.emailChanged(t.target.value)}}),r.a.createElement(I.h,{id:"password-input",label:"Password",type:"password",autoComplete:"password",margin:"normal",fullWidth:!0,value:this.state.password,error:""!==this.state.error,onChange:function(t){return e.passwordChanged(t.target.value)}}),t,r.a.createElement("div",null,r.a.createElement(I.c,{variant:"contained",size:"large",color:"primary",onClick:this.signIn.bind(this),style:Object(L.a)({},pe.buttonStyle,{flex:1,float:"right"})},"Submit"),r.a.createElement(I.c,{variant:"contained",size:"large",color:"primary",onClick:this.signUpScreen.bind(this),style:Object(L.a)({},pe.buttonStyle,{float:"left"})},"Sign Up")))}},{key:"emailChanged",value:function(e){this.setState({email:e})}},{key:"passwordChanged",value:function(e){this.setState({password:e})}},{key:"nameChanged",value:function(e){this.setState({name:e})}},{key:"profilePictureChanged",value:function(e){this.setState({profilePicture:e})}},{key:"signIn",value:function(){var e=this,t=this.state,a=t.email,n=t.password;""!==a&&void 0!==a?""!==n&&void 0!==n?g.auth().signInWithEmailAndPassword(a,n).catch(function(t){var a=t.message;e.setState({error:a})}):this.setState({error:"Password is required"}):this.setState({error:"Email is required"})}},{key:"signUp",value:function(){var e=this,t=this.state,a=t.email,n=t.password,r=t.name,i=t.profilePicture;""!==a&&void 0!==a?""!==n&&void 0!==n?g.auth().createUserWithEmailAndPassword(a,n).then(function(){g.auth().currentUser.getIdToken(!0).then(function(e){fetch("".concat(U,"/api/users"),{method:"POST",body:JSON.stringify({name:r,profile_picture:i}),headers:{"Content-Type":"application/json",authorization:e}})})}).catch(function(t){e.setState({error:t.message})}):this.setState({error:"Password is required"}):this.setState({error:"Email is required"})}},{key:"signUpScreen",value:function(){this.setState({signUpScreen:!0,error:""})}},{key:"loginScreen",value:function(){this.setState({signUpScreen:!1,error:""})}}]),t}(n.Component),me=Object(_.withStyles)(function(e){return{root:{flexGrow:1,zIndex:1,overflow:"hidden",position:"relative",display:"flex",height:"100vh",flex:1},appBar:{zIndex:e.zIndex.drawer+1},drawerPaper:{position:"relative",whiteSpace:"nowrap",width:he,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},content:{flexGrow:1,backgroundColor:e.palette.background.default,padding:3*e.spacing.unit,minWidth:0},toolbar:e.mixins.toolbar}})(de),ge=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={user:{}},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(p.a,null,r.a.createElement("div",null,r.a.createElement(d.a,{exact:!0,path:"/",render:function(t){return r.a.createElement(ue,Object.assign({},t,{user:e.state.user}))}}),r.a.createElement(d.a,{path:"/login",render:function(t){return r.a.createElement(me,Object.assign({},t,{user:e.state.user}))}})))}},{key:"componentDidMount",value:function(){var e=this;g.auth().onAuthStateChanged(function(t){t?(e.setState({user:t}),g.auth().currentUser.getIdToken(!0).then(function(e){(z=a(372)("".concat(U),{query:{token:e}})).on("connect",function(){console.log("connected!")}),z.on("disconnect",function(){}),z.on("chat",function(e){console.log("CHAT!"),console.log(e),A(e)})})):e.setState({user:{}})})}}]),t}(n.Component),fe=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ve(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}s.a.render(r.a.createElement(ge,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("","/service-worker.js");fe?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):ve(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):ve(e)})}}()}},[[232,2,1]]]);
//# sourceMappingURL=main.319ac1bb.chunk.js.map